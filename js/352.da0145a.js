(window.webpackJsonp=window.webpackJsonp||[]).push([[352],{1167:function(e,t,r){"use strict";r.r(t),r.d(t,"mutations",(function(){return h})),r.d(t,"getters",(function(){return v})),r.d(t,"state",(function(){return O})),r.d(t,"actions",(function(){return w}));r(17),r(18),r(20),r(7),r(22),r(15),r(21);var n=r(0),o=r(4),c=(r(9),r(2)),d=r(3),l=r(140);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){Object(o.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var h=m(m({},c.c),{},{SET_OLD_PROGRESS:function(e,t){e.oldProgress=t},SET_STEP_QUEST_COMPLETION_TIME:function(e,t){e.stepQuestCompletionTime.data=t}}),v=m(m({},c.b),{},{getBySeason:function(e){return e.getBySeason.data},progress:function(e){return e.progress.data}}),O=function(){return{achievements:{data:{},status:"success"},progress:{data:{},status:"success"},claimed:{data:{},status:"success"},getBySeason:{data:null,status:"success"},stepQuestCompletionTime:{data:null,status:"success"},oldProgress:{},create:{data:null,status:"success"},list:{data:[],status:"success"},getByExperience:{data:{},status:"success"},bulkUpdate:{data:null,status:"success"}}},w={getProgress:Object(d.a)({prop:"progress",func:l.a.getProgress}),claimProgress:Object(d.a)({prop:"claimed",func:l.a.claimProgress}),setOldProgress:function(e,t){e.commit("SET_OLD_PROGRESS",t)},create:Object(d.a)({prop:"create",func:l.a.createAchievement}),list:Object(d.a)({prop:"list",func:l.a.list}),getBySeason:Object(d.a)({prop:"getBySeason",func:l.a.getBySeason}),delete:Object(d.a)({prop:"delete",func:l.a.delete}),update:Object(d.a)({prop:"update",func:l.a.update}),bulkUpdate:Object(d.a)({prop:"bulkUpdate",func:l.a.bulkUpdate}),getByExperience:function(e,t){return Object(n.a)(regeneratorRuntime.mark((function r(){var n,o,d,f,m,h,v;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=e.state,d=t.expId,f=Object(c.a)(n,"getByExperience"),r.prev=3,h=null===(m=o.getByExperience)||void 0===m?void 0:m.data,r.next=7,l.a.getAllQuestsByExperience({expId:d});case 7:v=r.sent,h[d]=v,f.success(h),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(3),f.error(Object(c.d)(r.t0));case 15:case"end":return r.stop()}}),r,null,[[3,12]])})))()},stepQuestCompletionTime:Object(d.a)({prop:"stepQuestCompletionTime",func:l.a.getQuestByExperience}),setStepQuestCompletionTime:function(e,t){e.commit("SET_STEP_QUEST_COMPLETION_TIME",t)}}},1169:function(e,t,r){"use strict";r.r(t),r.d(t,"state",(function(){return d})),r.d(t,"mutations",(function(){return l})),r.d(t,"getters",(function(){return f})),r.d(t,"actions",(function(){return m}));var n=r(2),o=r(399),c=r(3),d=function(){return{createApproval:{data:null,status:"success"},updateApproval:{data:null,status:"success"},deleteApproval:{data:null,status:"success"}}},l=n.c,f=n.b,m={createApproval:Object(c.a)({prop:"createApproval",func:o.a.createApproval,toast:{success:"Request created.",error:"Request failed."}}),updateApproval:Object(c.a)({prop:"updateApproval",func:o.a.updateApproval,toast:{success:"Request updated.",error:"Request failed."}}),deleteApproval:Object(c.a)({prop:"deleteApproval",func:o.a.deleteApproval,toast:{success:"Request cancelled",error:"Request failed."}})}},1170:function(e,t,r){"use strict";r.r(t),r.d(t,"state",(function(){return X})),r.d(t,"mutations",(function(){return Z})),r.d(t,"getters",(function(){return ee})),r.d(t,"actions",(function(){return te}));r(17),r(18),r(20),r(22),r(21),r(50),r(69),r(38),r(64),r(70);var n=r(19),o=r(27),c=r(4),d=r(0),l=(r(9),r(7),r(35),r(36),r(53),r(840),r(54),r(31),r(89),r(40),r(41),r(15),r(141)),f=r(112),m=r(2),h=r(30),v=r(5),O=r(28),w=r(784),x=r(133),y=r(340),k=r(127);function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,d=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){d=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(d)throw o}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){Object(c.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=function(){return Promise.resolve().then(r.bind(null,177))},P=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Missing asset type");case 2:if(["ERC20","ERC721","ERC1155"].includes(t)){e.next=4;break}throw new Error("Invalid asset type");case 4:return r={ERC20:"0x1",ERC721:"0x2",ERC1155:"0x3"},e.abrupt("return",r[t]);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled(t.map((function(e){return Object(v.o)(e,v.a.CURRENT,!0,!1)})));case 2:for(r=e.sent,n=[],o=[],i=0;i<r.length;i++)"fulfilled"===(c=r[i]).status?n.push(S({},c.value)):o.push("".concat(t[i]," contract not initialized: ").concat(c.reason));if(!(o.length>0)){e.next=8;break}throw new Error(o.join("\n"));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e,t){window.$nuxt.$gtmEvent({event:e,auction:t})},B=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r,n){var param,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.$nuxt.$gtmEvent({event:t,auction:r}),!r){e.next=7;break}return param=r.NftOrderDetails[0].tokenId?{tokenId:r.NftOrderDetails[0].tokenId}:{blockchainId:r.NftOrderDetails[0].blockchainId},e.next=5,$nuxt.$store.dispatch("assetonsale/getAssetOrders",param);case 5:o=e.sent,n&&((c=S({},n)).status="purchased",c.order=o,$nuxt.$store.dispatch("cart/cleanItem",c));case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$nuxt.$store.dispatch("products/updateAssetPrivateFlag",{id:t,value:!1});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(e,t){var r=S({},e);r.status=t,$nuxt.$store.dispatch("cart/updateItem",r)},D=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r,n,o){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f.a.create(t,r,n,f.a.product.ASSET,o);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),null!==e.t0&&void 0!==e.t0&&e.t0.response&&400!==e.t0.response.status&&console.error(e.t0.response.data);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,r,n,o){return e.apply(this,arguments)}}(),U=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>2&&void 0!==c[2]?c[2]:v.a.POLYGON,o=Object(v.c)(t),r.loading("unlocking wallet"),e.next=5,Object(h.l)();case 5:return r.loading("switching network"),e.next=8,Object(v.s)(n,o);case 8:return e.abrupt("return",{walletAddress:o});case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),F=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t("sand/checkBalance",{amount:r,layer:v.a.POLYGON},{root:!0});case 2:if(e.sent){e.next=5;break}throw new Error("Not enough SAND");case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),M=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r,n,o,c){var d,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=Object(v.e)(t),e.next=3,Object(v.f)(r,d,n,o);case 3:return l=e.sent,e.abrupt("return",l>=c);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,o,c){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(v.i)(["matic"],t,"current");case 2:if(r=e.sent,r.matic&&"-"!==r.matic){e.next=6;break}throw new Error("Not enough MATIC, you can pay gas fees on SAND going to Blockchain Settings");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n,c,d,l,f,m,h,v,O,w,x,y,j;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.dispatch,n=t.commiter,c=t.walletAddress,d=t.canUseForward,l=void 0!==d&&d,f=t.canUseGasless,m=void 0!==f&&f,h=t.chainId,v=t.contractAddress,e.t0=!l,!e.t0){e.next=5;break}return e.next=5,G(c);case 5:return n.loading("fetching contracts"),e.next=8,k.a.getByAddressAndChain(v,h);case 8:return O=e.sent,e.next=11,I([O.name,"ExchangeMeta"]);case 11:return w=e.sent,x=Object(o.a)(w,2),y=x[0],j=x[1],e.next=17,y.methods.isApprovedForAll(c,j.options.address).call();case 17:if(!e.sent){e.next=20;break}return e.abrupt("return",!0);case 20:return n.loading("waiting confirmation"),e.abrupt("return",r("biconomy/callBiconomyTx",{method:"setApprovalForAll",contractName:O.name,params:[j.options.address,!0],sendParams:{from:c},callbackSuccess:function(){return!0},callbackError:function(){return!1},callbackFailure:function(){return!1},forward:l,gasless:m,skipSwitch:!0},{root:!0}));case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,d,l,f,m,v,O;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.assetContractAddress,o=t.sandContractAddress,c=t.order,d=null===(r=window)||void 0===r?void 0:r.userWeb3){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,E();case 6:return l=e.sent,f=l.default,m=c.NftOrderDetails[0].Token.type,e.next=11,P(m);case 11:return v=e.sent,e.next=14,P("ERC20");case 14:return O=e.sent,e.abrupt("return",{maker:c.Wallet.address,makeAsset:{assetType:{assetClass:v,data:d.eth.abi.encodeParameters(["address","uint256"],[n,c.NftOrderDetails[0].blockchainId])},value:f.toBN(c.qtyInitial,16).toString(10)},taker:h.m,takeAsset:{assetType:{assetClass:O,data:d.eth.abi.encodeParameter("address",o)},value:f.toWei(String(c.price),"ether")},salt:c.salt,start:c.startDate,end:c.endDate});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r){var c,h,v,O,w,x,y,k,j,A,R,S,E,P,T,U,F,M,G,$,W;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=t.commit,v=t.dispatch,O=r.data,w=O.booked,x=O.walletAddress,y=O.totalAmountWei,k=r.options,j=k.canUseForward,A=void 0!==j&&j,R=k.canUseGasless,S=void 0!==R&&R,null===(c=window)||void 0===c?void 0:c.userWeb3){e.next=5;break}return e.abrupt("return");case 5:return E=Object(m.a)(h,"purchase"),e.prev=6,E.loading("fetching contracts"),e.next=10,I(["ExchangeMeta"]);case 10:return P=e.sent,T=Object(o.a)(P,1),U=T[0],F=w.map((function(e){var t=e.order,r=e.qty;return{id:t.id,amount:r}})),M=0,e.next=17,l.a.getPurchaseData(F);case 17:G=e.sent,$=U.methods.matchOrdersFrom(x,G).encodeABI(),W=U.options.address,v("biconomy/callBiconomyTx",{contractName:"Sand",method:"approveAndCall",params:[W,y,$],sendParams:{from:x,value:M},callbackSuccess:function(){Promise.allSettled(w.map(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.order,n=t.asset,e.next=3,B("buyAssetSuccess",r,n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).catch((function(){}))},callbackFailure:function(){},callbackError:function(){Promise.allSettled([z(w)].concat(Object(n.a)(w.map(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.order,N("buyAssetError",r);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())))).catch((function(){}))},callbackPending:function(e){E.success(e),Promise.allSettled(w.map(function(){var t=Object(d.a)(regeneratorRuntime.mark((function t(r){var n,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.bookingId,o=r.order,c=r.qty,t.next=3,l.a.extendBooking(o.id,n,{qty:c}).catch((function(e){console.error(e)}));case 3:return t.next=5,D(e,f.a.currency.SAND,o.price*c,o.id).catch((function(e){console.error(e)}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).catch((function(){}))},forward:A,gasless:S},{root:!0}),e.next=28;break;case 24:throw e.prev=24,e.t0=e.catch(6),Promise.allSettled(w.map(function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.nft,C(r,"canceled");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).catch((function(){})),e.t0;case 28:case"end":return e.stop()}}),e,null,[[6,24]])})));return function(t,r){return e.apply(this,arguments)}}(),L=function(e,t,r,n){var data=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(C(e,r?"failed":"in progress"),t){var o=x.a.isAxiosError(t),c=o?"Network or timeout error":Object(m.d)(t);(!o||t.response&&t.response.status<500)&&n.error(c)}else n.success(data);return{retry:r,data:data,error:t}},Q=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.bookingId,o=t.order,c=t.qty,d=t.asset,e.abrupt("return",Object(w.a)(l.a.findBookingById,[o.id,n,{qty:c}],(function(data,e){return e?!data||!e.response||e.response.status<500?L(d,e,!0,r):L(d,e,!1,r):"processing"===data?L(d,"Processing",!0,r):(data.asset=S(S({},d),{},{status:"purchased"}),L(d,null,!1,r,data))}),1e3));case 2:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),H=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return r=e.sent,n=r.default,e.abrupt("return",n.toWei(t.toString(),"ether"));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(e,t){var r=[],n=[];return e.forEach((function(e){"rejected"===e.status?n.push(S({},e.reason)):"fulfilled"===e.status&&r.push({booking:e,promise:Q(e.value,t)})})),{failedBookings:n,orderBookedPromises:r}},V=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n=[],e.next=4,Promise.allSettled(t.map((function(e){return e.promise})));case 4:return e.sent.forEach((function(e,o){if("fulfilled"===e.status&&e.value&&e.value.data)r.push(S({},e.value.data));else{var c=t[o].booking,d=new Error("Failed to get booking: ".concat(c.bookingId));d.orderInfo=c.order,d.originalError=e.reason,n.push(S({},d))}})),e.abrupt("return",{booked:r,failedBookings:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.order,n=t.qty,e.prev=1,e.next=4,l.a.book(r.id,{qty:n});case 4:return o=e.sent,e.abrupt("return",S({bookingId:o},t));case 8:throw e.prev=8,e.t0=e.catch(1),console.error(e.t0),(c=new Error("Failed to book order: ".concat(r.id))).orderInfo=S({},t),c.originalError=e.t0,c;case 15:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){var r,n,o,c,d,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=j(t),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=18;break}if(o=n.value,e.prev=5,c=o.order,d=o.bookingId,f=o.qty,d){e.next=9;break}return e.abrupt("continue",16);case 9:return e.next=11,l.a.unbook(c.id,d,{qty:f});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error("Failed to unbook order: ".concat(o.order.id),e.t0);case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t1=e.catch(1),r.e(e.t1);case 23:return e.prev=23,r.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[1,20,23,26],[5,13]])})));return function(t){return e.apply(this,arguments)}}(),K=function(e){var t=e.walletAddress;e.ordersData.forEach((function(e){var r=e.order,n=e.qty,o=e.userAddress;if(parseInt(n,10)>parseInt(r.qtyAvailable,10))throw new Error("Asset copies quantity error");if((null==t?void 0:t.toString().toLowerCase())!==(null==o?void 0:o.toString().toLowerCase()))throw new Error("User address is not the same as the wallet address")}))},X=function(){return{order:{data:null,status:"default"},assetOrders:{data:null,status:"default"},booking:{data:null,status:"default"},purchase:{data:null,status:"default"},cancelSale:{data:null,status:"default"},putOnSale:{data:null,status:"default"}}},Z=m.c,ee=m.b,te={bookAndPurchase:function(e,t){return Object(d.a)(regeneratorRuntime.mark((function r(){var o,c,d,l,f,h,v,w,x,y,k,j,A,R,S,E,P,I,N,B,T,C,D;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=e.commit,c=e.dispatch,d=e.rootGetters,l=t.data,f=l.ordersData,h=l.totalAmount,v=t.options,w=v.canUseForward,x=void 0!==w&&w,y=v.canUseGasless,k=void 0!==y&&y,j=Object(m.a)(o,"booking"),r.prev=3,r.next=6,U(d,j);case 6:return A=r.sent,R=A.walletAddress,j.loading("validating sand balance"),r.next=11,H(h);case 11:return S=r.sent,r.next=14,F(c,S);case 14:return r.next=16,Promise.allSettled(f.map((function(e){return Y(e)})));case 16:return E=r.sent,P=J(E,j),I=P.failedBookings,N=P.orderBookedPromises,r.next=20,V(N);case 20:if(B=r.sent,T=B.booked,C=B.failedBookings,T.length){r.next=25;break}throw new Error("Something went wrong booking orders");case 25:return K({walletAddress:R,ordersData:T}),C.length&&I.push.apply(I,Object(n.a)(C)),I.length,r.next=30,_({commit:o,dispatch:c},{data:{booked:T,walletAddress:R,totalAmountWei:S},options:{canUseForward:x,canUseGasless:k}});case 30:r.next=40;break;case 32:return r.prev=32,r.t0=r.catch(3),r.next=36,z(f);case 36:throw D=Object(m.d)(r.t0),j.error(D),Object(O.b)({title:D}),r.t0;case 40:case"end":return r.stop()}}),r,null,[[3,32]])})))()},cancelSale:function(e,t){return Object(d.a)(regeneratorRuntime.mark((function r(){var n,c,f,h,v,O,w,x,j,A,R,S,E,P,T,C,D,F,M,G,$,_;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,c=e.dispatch,f=e.rootGetters,h=t.saleId,v=t.contractAddress,O=t.chainId,w=t.options,x=w.canUseForward,j=void 0!==x&&x,A=w.canUseGasless,R=void 0!==A&&A,S=Object(m.a)(n,"cancelSale"),r.prev=3,r.next=6,U(f,S);case 6:return E=r.sent,P=E.walletAddress,S.loading("fetching order info"),r.next=11,l.a.getNftOrder(h);case 11:if(T=r.sent){r.next=14;break}throw new Error("Nft Order not found");case 14:if(!T.legacyId){r.next=18;break}return r.next=17,window.$nuxt.$store.dispatch("assetsignedauction/cancelSellerOffer",T.legacyId);case 17:return r.abrupt("return",r.sent);case 18:return S.loading("fetching contracts"),r.next=21,k.a.getByAddressAndChain(v,O);case 21:return C=r.sent,r.next=24,I(["Sand",C.name]);case 24:return D=r.sent,F=Object(o.a)(D,2),M=F[0],G=F[1],r.next=30,W({order:T,sandContractAddress:M.options.address,assetContractAddress:G.options.address});case 30:$=r.sent,_=[Object(y.b)($),T.orderHash],S.loading("waiting confirmation"),c("biconomy/callBiconomyTx",{contractName:"ExchangeMeta",method:"cancel",params:_,sendParams:{from:P},callbackSuccess:function(){var e=Object(d.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.flagAsCanceling(h);case 2:return e.next=4,B("cancelAuctionSuccess",T);case 4:S.success(t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),callbackFailure:function(e){N("cancelAuctionError",T),S.error(e)},forward:j,gasless:R},{root:!0}),r.next=40;break;case 36:throw r.prev=36,r.t0=r.catch(3),S.error(Object(m.d)(r.t0)),r.t0;case 40:case"end":return r.stop()}}),r,null,[[3,36]])})))()},getAssetOrders:function(e,t){return Object(d.a)(regeneratorRuntime.mark((function r(){var n,o,c,d,f,h,v;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.commit,o=t.assetId,c=t.tokenId,d=t.sellerId,f=Object(m.a)(n,"assetOrders"),r.prev=3,o||c){r.next=8;break}return f.success([]),Object(m.a)(n,"order").success(null),r.abrupt("return");case 8:if(f.loading("fetching orders"),Object(m.a)(n,"order").loading("fetching nft order"),h=[],!o){r.next=17;break}return r.next=14,l.a.findAllByAssetId(o,{sellerId:d});case 14:h=r.sent,r.next=21;break;case 17:if(!c){r.next=21;break}return r.next=20,l.a.findAllByTokenId(c,{sellerId:d});case 20:h=r.sent;case 21:return f.success(h),v=h.length?h[0]:null,Object(m.a)(n,"order").success(v),r.abrupt("return",v);case 27:throw r.prev=27,r.t0=r.catch(3),f.error(Object(m.d)(r.t0)),r.t0;case 31:case"end":return r.stop()}}),r,null,[[3,27]])})))()},putOnSale:function(e,t){return Object(d.a)(regeneratorRuntime.mark((function r(){var n,o,c,data,d,f,v,O,w,x,y,k,j,A,R;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=e.dispatch,c=e.rootGetters,data=t.data,d=t.options,f=d.canUseForward,v=void 0!==f&&f,O=d.canUseGasless,w=void 0!==O&&O,x=Object(m.a)(n,"putOnSale"),r.prev=3,r.next=6,U(c,x);case 6:return y=r.sent,k=y.walletAddress,r.next=10,$({commiter:x,dispatch:o,walletAddress:k,canUseForward:v,canUseGasless:w,chainId:data.chainId,contractAddress:data.contractAddress});case 10:if(r.sent){r.next=13;break}throw new Error("Approval is needed to list for sale.");case 13:return x.loading("creating nft order"),r.next=16,l.a.create(data);case 16:return j=r.sent,x.loading("fetching order info"),r.next=20,l.a.getNftOrder(j.id);case 20:if(r.sent){r.next=23;break}throw new Error("Nft Order not found");case 23:return x.loading("fetching data"),r.next=26,l.a.getNftOrderData(j.id);case 26:return A=r.sent,x.loading("requesting signature"),r.next=30,Object(h.k)(k,A);case 30:return R=r.sent,x.loading("updating nft order"),r.next=34,l.a.update(j.id,{signature:R});case 34:if(x.success(S(S({},j),{},{signature:R})),!data.isAssetPrivate){r.next=38;break}return r.next=38,T(data.assetId);case 38:r.next=44;break;case 40:throw r.prev=40,r.t0=r.catch(3),x.error(Object(m.d)(r.t0)),r.t0;case 44:case"end":return r.stop()}}),r,null,[[3,40]])})))()},validateOrderBalances:function(e,t){return Object(d.a)(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.map((function(e){var t,r,n,o=e.order,c=e.qty,d=o.Wallet.address,l=o.NftOrderDetails[0],f=null==l||null===(t=l.Token)||void 0===t||null===(t=t.Contract)||void 0===t?void 0:t.chainId,m=null==l||null===(r=l.Token)||void 0===r||null===(r=r.Contract)||void 0===r?void 0:r.name,h=null==l||null===(n=l.Token)||void 0===n?void 0:n.blockchainId;return M(f,m,d,h,c)})),e.next=3,Promise.allSettled(r);case 3:return n=e.sent,e.abrupt("return",n.every((function(e){return"fulfilled"===e.status&&e.value})));case 5:case"end":return e.stop()}}),e)})))()}}},1211:function(e,t,r){"use strict";r.r(t),r.d(t,"state",(function(){return m})),r.d(t,"mutations",(function(){return h})),r.d(t,"getters",(function(){return v})),r.d(t,"actions",(function(){return O}));var n,o,c=r(0),d=(r(9),r(2)),l=r(49),f=r(3),m=function(){return{changeUploader:{data:null,status:"success"},assetByBlockchainId:{data:null,status:"success"},updateRarity:{data:null,status:"success"},textModeration:{data:null,status:"success"}}},h=d.c,v=d.b,O={changeUploader:Object(f.a)({prop:"changeUploader",func:l.a.changeUploader,toast:{success:"Change owner success",error:"Change owner error"}}),assetByBlockchainId:Object(f.a)({prop:"assetByBlockchainId",func:l.a.getAssetByBlockchainId}),createAsset:Object(f.a)({prop:"createAsset",func:l.a.createAsset,toast:{error:"Failed to create asset"}}),updateAsset:Object(f.a)({prop:"updateAsset",func:l.a.updateAsset,toast:{error:"Failed to update asset"}}),viewProvisional:Object(f.a)({prop:"viewProvisional",func:l.a.viewProvisional}),readAsset:Object(f.a)({prop:"readAsset",func:l.a.readAsset}),updateRarity:Object(f.a)({prop:"updateRarity",func:l.a.updateRarity,toast:{error:"Error updating asset rarity"}}),publish:Object(f.a)({prop:"publish",func:l.a.publishAsset,toast:{error:"Failed!"}}),report:Object(f.a)({prop:"report",func:l.a.reportAsset}),textModeration:(o=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var n,o,c,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.commit,(o=Object(d.a)(n,"textModeration")).loading(),e.prev=3,e.next=6,l.a.performTextModeration(r);case 6:return f=e.sent,o.success(f.data),e.abrupt("return",{isValid:0===(null===(c=f.data)||void 0===c?void 0:c.length),data:f.data});case 11:e.prev=11,e.t0=e.catch(3),console.error(e.t0),o.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])}))),function(e,t){return o.apply(this,arguments)}),clearTextModeration:(n=Object(c.a)(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.commit,Object(d.a)(r,"textModeration").success(null);case 3:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}},1213:function(e,t,r){"use strict";r.r(t),r.d(t,"mutations",(function(){return v})),r.d(t,"getters",(function(){return O})),r.d(t,"state",(function(){return w})),r.d(t,"actions",(function(){return x}));var n=r(0),o=(r(9),r(53),r(67),r(2)),c=r(30),d=r(5),l=r(111),f=r(754),m=r(571),h=r(44),v=o.c,O=o.b,w=function(){return{contractAddress:{data:null,status:"success"},mint:{data:null,status:"success"}}},x={loadContractByLayer:function(e,t){return Object(d.o)(t.contractName,t.layer,!0)},mint:function(e,t){return Object(n.a)(regeneratorRuntime.mark((function r(){var n,v,O,w,x,y,k,j,A,R,S,E,P,I,N,B,T;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=e.commit,v=e.rootGetters,O=e.dispatch,w=t.assetIds,x=t.supplies,y=t.catalysts,k=t.layer,j=t.forward,A=t.gasless,R=t.workspaceId,S=Object(o.a)(n,"mint"),r.prev=3,S.loading(0),r.next=7;break;case 7:if(k){r.next=9;break}throw new Error("Layer is required!");case 9:if(E=v["user/getUser"]){r.next=12;break}throw new Error("Not authenticated");case 12:if(P=v["user/getWallet"]){r.next=15;break}throw new Error("User has no wallet");case 15:return r.next=17,Object(c.l)();case 17:return r.next=19,Object(d.s)(k,P);case 19:return r.next=21,Object(l.c)(w,x,y,E.id,k);case 21:return I=r.sent,N=I.method,B=I.params,S.loading({method:N,params:B}),y.includes(h.o.universal)&&(j=!1,A=!1),r.next=28,O("biconomy/callBiconomyTx",{contractName:"AssetV2Create",method:N,params:B,sendParams:{from:P},forward:j,gasless:A},{root:!0});case 28:return r.next=30,Object(l.b)(w,E.id);case 30:r.next=40;break;case 32:return r.prev=32,r.t0=r.catch(3),r.next=36,f.a.updateState(w,{state:m.f.NOT_MINTED},R);case 36:throw T=Object(o.d)(r.t0),S.error(T),Object(l.d)(T),r.t0;case 40:case"end":return r.stop()}}),r,null,[[3,32]])})))()}}},177:function(e,t,r){"use strict";r.r(t);var n=r(45),o=(r(10),r(11),r(12),r(13),r(7),r(41),r(159),r(113)),c=r(43),d=r.n(c);t.default={fromAscii:function(e){return o.fromAscii(e)},fromWei:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ether";return o.fromWei(e.toString(),t)},hexToAscii:function(e){return o.hexToAscii(e)},hexToNumber:function(e){return o.hexToNumber(e)},hexToNumberString:function(e){return o.hexToNumberString(e)},isAddress:function(e){return o.isAddress(e)},padLeft:function(e,t,r){return o.padLeft(e,t,r)},randomHex:function(e){return o.randomHex(e)},sha3:function(data){return o.sha3(data)},soliditySha3:function(){return o.soliditySha3.apply(o,arguments)},soliditySha3Raw:function(){return o.soliditySha3Raw.apply(o,arguments)},toBN:function(e,base){return new d.a(e.toString(),base)},toChecksumAddress:function(address){return o.toChecksumAddress(address)},toHex:function(e){var t,r=e;return"object"===Object(n.a)(e)&&e instanceof d.a&&(r=e.toNumber()),"string"!=typeof(t=r)||isNaN(t)||isNaN(parseFloat(t))||(r=Number(r)),o.toHex(r)},toWei:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ether",r=e;switch(Object(n.a)(e)){case"number":r=String(e);break;case"object":e instanceof d.a&&(r=e.toString())}return o.toWei(r,t).toString()}}},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));r(18),r(20),r(22),r(15),r(21);var n=r(4),o=r(45);r(10),r(11),r(12),r(13),r(319),r(54),r(7),r(17);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){Object(n.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(data,e,t){return JSON.stringify(function(e){var t=[];function r(e){if(null===e||"object"!==Object(o.a)(e))return e;if(-1!==t.indexOf(e))return"[Circular]";if(t.push(e),"function"==typeof e.toJSON)try{var n=r(e.toJSON());return t.pop(),n}catch(e){return m(e)}if(Array.isArray(e)){var c=e.map(r);return t.pop(),c}if(e instanceof Error)return d(d({},e),{},{stack:e.stack});var l=Object.keys(e).reduce((function(t,n){return t[n]=r(function(e,t){if(f.call(e,t))try{return e[t]}catch(e){return m(e)}return e[t]}(e,n)),t}),{});return t.pop(),l}return r(e)}(data),e,t)}var f=Object.prototype.hasOwnProperty;function m(e){return"[Throws: "+(e?e.message:"?")+"]"}}}]);